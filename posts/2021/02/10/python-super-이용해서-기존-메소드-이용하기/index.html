<!doctype html><html lang=en><head><title>[Python] super() 이용해서 기존 메소드 이용하기 &ndash; litsynp.log</title>
<meta name=description content><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=UTF-8><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A==" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.1/css/academicons.min.css integrity="sha512-b1ASx0WHgVFL5ZQhTgiPWX+68KjS38Jk87jg7pe+qC7q9YkEtFq0z7xCglv7qGIs/68d3mAp+StfC8WKC5SSAg==" crossorigin=anonymous><link rel=stylesheet href=https://blog.litsynp.com/css/palettes/base16-dark.css><link rel=stylesheet href=https://blog.litsynp.com/css/risotto.css><link rel=stylesheet href=https://blog.litsynp.com/css/custom.css><link rel=icon href=https://blog.litsynp.com/favicon.ico></head><body><div class=page><header class=page__header><nav class="page__nav main-nav"><ul><h1 class=page__logo><a href=https://blog.litsynp.com/ class=page__logo-inner>litsynp.log</a></h1><li class=main-nav__item><a class=nav-main-item href=https://blog.litsynp.com/posts title>posts</a></li><li class=main-nav__item><a class=nav-main-item href=https://blog.litsynp.com/tags title>tags</a></li><li class=main-nav__item><a class=nav-main-item href=https://blog.litsynp.com/categories title>categories</a></li><li class=main-nav__item><a class=nav-main-item href=https://blog.litsynp.com/series title>series</a></li></ul></nav></header><section class=page__body><header class=content__header><h1>[Python] super() 이용해서 기존 메소드 이용하기</h1></header><div class=content__body><h2 id=why-use-it>Why use it?</h2><p>프로젝트에서 <strong>Django REST Framework</strong>를 사용하고 있는데, <code>serializer</code>나 <code>viewset</code>을 사용할 때, 특히 <code>ModelViewSet</code> 을 override할 때 HTTP 메소드에 따른 함수를 수정하고 싶을 때가 있다.</p><p>그럴 때 특정 분기에 따라 override하기 전의 클래스 메소드를 사용하고 싶은 때가 있다.</p><p>예시는 다음과 같다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># ViewSet 안의 메소드</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>destroy</span>(self, request, <span style=color:#f92672>*</span>args, <span style=color:#f92672>**</span>kwargs):
</span></span><span style=display:flex><span>    user_id <span style=color:#f92672>=</span> int(self<span style=color:#f92672>.</span>kwargs<span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#39;pk&#39;</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 로그인한 사용자와 조회하려는 사용자의 ID가 일치한지 확인</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> self<span style=color:#f92672>.</span>request<span style=color:#f92672>.</span>user<span style=color:#f92672>.</span>id <span style=color:#f92672>==</span> user_id:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> super(UserViewSet, self)<span style=color:#f92672>.</span>destroy(request, <span style=color:#f92672>*</span>args, <span style=color:#f92672>**</span>kwargs)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        response <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;detail&#39;</span>: <span style=color:#e6db74>&#39;Delete function is not offered without authorization as the owner.&#39;</span>}
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> Response(response, status<span style=color:#f92672>=</span>status<span style=color:#f92672>.</span>HTTP_403_FORBIDDEN)
</span></span></code></pre></div><p>아무튼 예시에 간략하게 설명을 덧붙이자면, 다음과 같다.</p><ul><li>제시한 <code>destroy</code> 함수는 DRF의 <code>ModelViewSet</code> 를 상속한 클래스인 <code>UserViewSet</code> 내의 함수이다.</li><li><code>destroy</code> 함수를 override하여 새로운 기능을 제공하고자 한다.</li><li>로그인한 사용자의 ID와, URL에 있는 parameter (<code>/users/:pk</code>)의 <code>pk</code> 부분, 즉 조회하려는 사용자의 ID가 일치하는지를 확인한다.<ul><li>일치하면 <code>super()</code> 를 이용하여 기존 <code>destroy</code> 함수를 호출해 해당 사용자를 DB에서 삭제한다.</li><li>일치하지 않으면 HTTP 상태 코드 403 Forbidden와 함께 response 메세지를 JSON으로 반환한다.</li></ul></li></ul><h3 id=참고>참고</h3><ul><li>위와 같이 작성하면 물론 로그인을 했는지부터 확인해야하기 때문에 <code>permission_classes</code>를 작성해야 한다.</li><li>또한, 위의 함수만 작성하면 DRF의 admin site에서는 DELETE 버튼이 비활성화되지 않는다. (물론 클릭하면 권한에 따라 reject 될 것이다)</li></ul><h2 id=ref>REF</h2><p><a href=https://stackoverflow.com/questions/1817183/using-super-with-a-class-method>Using super with a class method - (Stack Overflow)</a></p></div><footer class=content__footer></footer></section><section class=page__aside><div class=aside__about><div class=aside__about><h1 class=about__title>litsynp.log</h1></div><ul class=aside__social-links><li><a href=https://www.github.com/litsynp rel=me aria-label=GitHub title=GitHub><i class="fa-brands fa-github" aria-hidden=true></i></a>&nbsp;</li><li><a href=https://www.linkedin.com/in/litsynp rel=me aria-label=LinkedIn title=LinkedIn><i class="fa-brands fa-linkedin" aria-hidden=true></i></a>&nbsp;</li><li><a href=https://docs.litsynp.com rel=me aria-label=GitBook title=GitBook><i class="fa fa-book" aria-hidden=true></i></a>&nbsp;</li><li><a href=mailto:nocte55is@gmail.com rel=me aria-label=Email title=Email><i class="fa-solid fa-envelope" aria-hidden=true></i></a>&nbsp;</li></ul><section><div>Latest Posts:</div><li><a href=https://blog.litsynp.com/posts/2024/07/28/weird-chars-on-macos/>맥북에서 한글 입력 시 알 수 없는 문자가 같이 입력되는 버그</a></li><li><a href=https://blog.litsynp.com/posts/2023/10/10/flip-flops-and-latches/>Flip-Flops and Latches</a></li><li><a href=https://blog.litsynp.com/posts/2023/10/08/hugo-from-scratch/>Hugo 블로그 만들기</a></li></section></div><hr><div class=aside__content><p>2021-02-10</p></div></section><section class=page__comments><script src=https://utteranc.es/client.js repo=litsynp/litsynp.github.io issue-term=pathname theme=github-dark crossorigin=anonymous async></script></section><footer class=page__footer><p><br><span class=active>$ echo $LANG<br><b>English</b></span><br></p><br><br><p class=copyright>© <a href=https://github.com/litsynp>litsynp</a>.</p><p class=advertisement>Powered by <a href=https://gohugo.io/>hugo</a> and <a href=https://github.com/joeroe/risotto>risotto</a>.</p></footer></div></body></html>